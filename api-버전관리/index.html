<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 4.18.0"/><style data-href="/styles.db05a864f5362495e721.css" data-identity="gatsby-global-css">body{font-family:Arial,Helvetica,sans-serif;font-size:17px;line-height:22px;margin:0}._404-module--content--OUNuJ{background-color:#fafafa;padding:20px}._404-module--content--OUNuJ ._404-module--header--FWmI-{color:red}._404-module--content--OUNuJ ._404-module--error-message--diUlb{color:gray;font-size:20px}.layout-module--container--RoCXy{min-height:100vh;position:relative}.layout-module--container--RoCXy .layout-module--content--FwTjf{margin:0 auto;max-width:960px;padding-bottom:100px}.layout-module--container--RoCXy .layout-module--content--FwTjf a{color:#000}@media screen and (min-width:1px)and (max-width:1000px){.layout-module--container--RoCXy .layout-module--content--FwTjf{padding-left:20px;padding-right:20px}}.header-module--container--i1m8L{margin:50px auto 0;max-width:960px;min-height:140px;padding-top:30px}.header-module--container--i1m8L .header-module--row--PMRLn{padding:5px;text-align:center}.header-module--container--i1m8L .header-module--button--MRlxv,.header-module--container--i1m8L .header-module--button-github--99DPx,.header-module--container--i1m8L .header-module--button-icon--lGaW9,.header-module--container--i1m8L .header-module--button-linkedin--bCjbJ,.header-module--container--i1m8L .header-module--button-twitter--a8R0i{background-color:#222f3e;color:#fff;display:inline-block;font-family:Verdana,Geneva,Tahoma,sans-serif;font-size:12px;font-weight:700;height:30px;line-height:30px;margin-bottom:10px;margin-right:10px;min-width:15px;padding-left:10px;padding-right:10px;text-transform:uppercase}.header-module--container--i1m8L .header-module--button--MRlxv:hover,.header-module--container--i1m8L .header-module--button-github--99DPx:hover,.header-module--container--i1m8L .header-module--button-icon--lGaW9:hover,.header-module--container--i1m8L .header-module--button-linkedin--bCjbJ:hover,.header-module--container--i1m8L .header-module--button-twitter--a8R0i:hover{background-color:#0984e3}.header-module--container--i1m8L .header-module--button-github--99DPx,.header-module--container--i1m8L .header-module--button-icon--lGaW9,.header-module--container--i1m8L .header-module--button-linkedin--bCjbJ,.header-module--container--i1m8L .header-module--button-twitter--a8R0i{background-position:50%;background-repeat:no-repeat;background-size:16px 16px}.header-module--container--i1m8L .header-module--button-github--99DPx{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QAAKqNIzIAAAAJcEhZcwAADdcAAA3XAUIom3gAAAAHdElNRQfiChgMFzkb2YICAAAA6klEQVQoz42RP0oDcRhE3y8gaFIJplAhWgXcQJoFwT6VkCJlDpALeAALS8scwBPEK+gBTCGCf1hwYRU3zRYWhsTqWShBiKu+8mOYYb6Bv7Fr3+rStWrfLgTwloiCY+7ZZAvImbDHCRvchRZgYRkFVICsND0DbDordZjZxJG/MQpmNIArLnhnnRryxis1DomAJ5yq5wZj40XF2NgVL9UpJuoumJouBKkpuK8mFcZI/mOHHBhjRz34tP0eAfbUDuDQa3eWXt320SEEAAcc8UJCwZzAKnVa1DkNZ18CACPabLOGzHnmJjz8Y2eAD7/5vvjSJOIHAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE4LTEwLTI0VDEyOjIzOjU3KzAyOjAwzxYwVwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOC0xMC0yNFQxMjoyMzo1NyswMjowML5LiOsAAAAZdEVYdFNvZnR3YXJlAHd3dy5pbmtzY2FwZS5vcmeb7jwaAAAAAElFTkSuQmCC)}.header-module--container--i1m8L .header-module--button-twitter--a8R0i{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QAAKqNIzIAAAAJcEhZcwAADdcAAA3XAUIom3gAAAAHdElNRQfiChgMIBW5Bk7VAAAA0ElEQVQoz4WRvWoCYRRE5xN0GxEb0Wq1CIKdYGGRQlIL+ggW8YFWSJEUtr6AjaCihVVsBUMkEEgtdsE/ciyM+q2r7Cnv3Bkuc6UQTHBERlVF1TdfEgnh0CJmyRVWAKx5Y0BKPAET0ueFby4MaYg8AD80cSVy2LSPnv558EHHt1CTRJExf9zGPSYs7shLSYpIetbnzQpGp7sdXlgH/Bvy/wlmo7mcgN8zdi4luj7/lPhFTPLIKztL9qxuKdOzpF8m1APPIquCHrTVu2ZmH/bfKw47VepU/0v6uQAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxOC0xMC0yNFQxMjozMjoyMSswMjowMIhPuIoAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTgtMTAtMjRUMTI6MzI6MjErMDI6MDD5EgA2AAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAABJRU5ErkJggg==);margin-right:0}.header-module--container--i1m8L .header-module--button-linkedin--bCjbJ{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QAAKqNIzIAAAAJcEhZcwAADdcAAA3XAUIom3gAAAAHdElNRQfiChgMHzpKCVmwAAAAi0lEQVQoz82QIQ7CQBBF3zYISBpO0XABDAaFQdaSIFZwoJ4DRYIjnAIcqoYKLAd4iJISsjQIDE9M/mT+/EwGV9buzenDWtXYN884Azzrx4Tc6JQfsKV6KYeu3Xn3aAGDZGPMgTkAC04uU0MkdHrEJksMgSslM24AlOkNjRMAq7ZNE7bh8v6oL/yD4QFJWUru4kp6/AAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxOC0xMC0yNFQxMjozMTo1OCswMjowMPwlT0MAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTgtMTAtMjRUMTI6MzE6NTgrMDI6MDCNePf/AAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAABJRU5ErkJggg==)}.header-module--container--i1m8L .header-module--link--jOlJU{color:#222f3e;font-family:Verdana,Geneva,Tahoma,sans-serif;font-size:17px;font-weight:700;text-decoration:none}.header-module--container--i1m8L .header-module--link--jOlJU:hover{color:#0984e3}.header-module--container--i1m8L .header-module--link--jOlJU:not(:last-child){padding-right:30px}.footer-module--container--5GliC{background-color:#222f3e;bottom:0;height:100px;position:absolute;width:100%}.footer-module--container--5GliC .footer-module--footer--Z1xkR{color:#fff;font-family:Verdana,Geneva,Tahoma,sans-serif;height:100px;line-height:100px;margin:0 auto;max-width:960px;padding:0 20px}.title-module--container--mDD1t{border-bottom:5px solid #576574;color:#576574;margin-bottom:30px;padding-bottom:10px;text-align:center;text-transform:uppercase}.title-module--container--mDD1t .title-module--title--cbUG\+{font-size:50px;line-height:60px}.title-module--container--mDD1t .title-module--subtitle--DRZhF{font-size:18px;font-weight:100}.article-module--article-box--GvYiU{border-bottom:1px dotted #777;box-shadow:inset 0 0 0 0 #fff;display:inline-block;margin-bottom:30px;transition:all .25s ease;width:100%}.article-module--article-box--GvYiU:hover{cursor:pointer}@media screen and (min-width:960px){.article-module--article-box--GvYiU:hover{box-shadow:inset 960px 0 0 0 #dfe6e9}}.article-module--article-box--GvYiU .article-module--left--MCqTJ{background-color:#fafafa;float:left;height:150px;width:150px}.article-module--article-box--GvYiU .article-module--right--ddbwg{color:#222f3e;margin-left:150px;margin-top:-20px;padding:15px}.article-module--article-box--GvYiU .article-module--right--ddbwg .article-module--date--jFkoy{font-size:12px;margin-bottom:20px;margin-top:-15px}.article-module--article-box--GvYiU .article-module--right--ddbwg h3{color:#222f3e}.post-module--container--e01vr .post-module--content--tnGN8{padding:20px}.post-module--container--e01vr .post-module--content--tnGN8 h1{color:#222f3e;line-height:50px;margin-bottom:30px}.post-module--container--e01vr .post-module--content--tnGN8 h2{color:#576574;line-height:30px;margin-bottom:30px;margin-top:30px}.post-module--container--e01vr .post-module--content--tnGN8 h3{color:#576574;line-height:25px;margin-bottom:30px;margin-top:30px}.post-module--container--e01vr .post-module--content--tnGN8 p{font-size:18px;line-height:30px;margin-bottom:10px;text-align:justify}</style></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="layout-module--container--RoCXy"><header class="header-module--container--i1m8L"><div class="header-module--row--PMRLn"><a href="/"><div class="header-module--button--MRlxv">Jake the dev</div></a><a href="https://www.github.com/jakeryu" target="_blank" rel="noopener noreferrer"><div class="header-module--button-github--99DPx"> </div></a><a href="https://www.linkedin.com/in/jakeryu" target="_blank" rel="noopener noreferrer"><div class="header-module--button-linkedin--bCjbJ"> </div></a><a href="https://twitter.com/jakeryu" target="_blank" rel="noopener noreferrer"><div class="header-module--button-twitter--a8R0i"> </div></a></div><div class="header-module--row--PMRLn"><a class="header-module--link--jOlJU" href="/">ARTICLES</a><a class="header-module--link--jOlJU" href="/about">ABOUT</a></div></header><div class="layout-module--content--FwTjf"><div class="post-module--container--e01vr"><div style="width:100%;height:640px;background-color:#fafafa;background-image:Url(https://picsum.photos/seed/version/960/640);background-size:cover;background-repeat:no-repeat;margin-bottom:30px"></div><section class="title-module--container--mDD1t"><h1 class="title-module--title--cbUG+">API 버전관리</h1><div class="title-module--subtitle--DRZhF"></div></section><div class="post-module--content--tnGN8"><p>API를 관리하면서 기능 향상이나 추가는 일상적인 요구사항이다. 이때, 기존 호환성을 유지해야 한다면 각기 다른 버전의 API를 제공할 필요가 있다. 마이크로소프트는 <code>Microsoft.AspNetCore.Mvc.Versioning</code> 패키지를 통해 ASP.NET Core의 REST API 버전을 쉽게 관리할 수 있도록 도와준다.</p>
<!--more-->
<h2>설정하기</h2>
<p>패키지를 설치한 후, <code>Startup.cs</code> 에서 기본적인 행동패턴을 설정하자.</p>
<deckgo-highlight-code language="csharp" terminal="carbon" theme="one-light" line-numbers="true"  >
          <code slot="code">// Startup.cs
services.AddApiVersioning(config =&gt;
{
    config.DefaultApiVersion = new ApiVersion(1, 0);
    config.AssumeDefaultVersionWhenUnspecified = true;
    config.ReportApiVersions = true;
    config.ApiVersionReader = new HeaderApiVersionReader(&quot;X-Version&quot;);
});</code>
        </deckgo-highlight-code>
<p><code>AssumeDefaultVersionWhenUnspecified</code> 속성을 <code>true</code>로 활성화하면, 클라이언트 요청에 버전 정보가 없을 경우, 기본 버전을 사용하도록 해준다. 이미 상당수의 API를 개발한 후 버전관리를 시작할 때 유용하다. <code>ReportApiVersions</code> 속성은 아래 그림과 같이 서버에서 제공하고 있는 API 버전을 보여준다. 응답 헤더에 <code>api-supported-verions</code>가 추가된 걸 확인할 수 있다.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/ffa0ce9fe54c2c9f35232f8fd5b860b8/e2d3b/api-supported-versions.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 35.50000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAvUlEQVQoz4WR0QrDIAxF+/8/ORjsZTA6NcZoa++4GV3LWDshGMrx5GqHGCOSCCQ88bheEO43ZEng92qGaZrQWvNin1JC1IRkglIL1BTZFKLZ94GQ5IxlWd7V+9Z/FReFRRVTa7BiMDMsfWOG3jtyziilYJ5nP3QmJBdCQEzRe1bfhXAhp47j6DsT/5Kth0TEhXyCde05F64Q4/c/V17ZI8aFqopa6yG0F5Ll4KOn+Qj5Vzmd/VlKDuZ1jxK+ALQ2Jn6lfB/fAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="api-supported-versions.png"
        title="api-supported-versions.png"
        src="/static/ffa0ce9fe54c2c9f35232f8fd5b860b8/5a190/api-supported-versions.png"
        srcset="/static/ffa0ce9fe54c2c9f35232f8fd5b860b8/772e8/api-supported-versions.png 200w,
/static/ffa0ce9fe54c2c9f35232f8fd5b860b8/e17e5/api-supported-versions.png 400w,
/static/ffa0ce9fe54c2c9f35232f8fd5b860b8/5a190/api-supported-versions.png 800w,
/static/ffa0ce9fe54c2c9f35232f8fd5b860b8/c1b63/api-supported-versions.png 1200w,
/static/ffa0ce9fe54c2c9f35232f8fd5b860b8/e2d3b/api-supported-versions.png 1466w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></p>
<p>위 설정에서는 헤더에서 버전정보를 읽도록 <code>HeaderApiVersionReader</code>를 사용했지만, 시나리오에 맞추어 <code>ApiVersionReader</code> 속성을 다르게 지정한다.</p>
<h2>버전 지정하기</h2>
<p>클라이언트가 버전을 지정하여 요청하면, 그 요청은 해당하는 컨트롤러와 액션으로 리다이렉트된다. 컨트롤러와 액션에 버전을 지정하는 방식에는 여러 접근법이 있다.</p>
<p>먼저, 버전에 따라 각각의 컨트롤러를 생성할 수 있지만, 아래 예시처럼 컨트롤러 하나에서 여러 버전을 관리할 수도 있다. 만약에 같은 컨트롤에서 여러 버전을 관리한다면 <code>[MpaToApiVersion]</code> 어트리뷰트를 통해 액션별로 버전을 매핑해야 한다.</p>
<deckgo-highlight-code language="csharp" terminal="carbon" theme="one-light" line-numbers="true"  >
          <code slot="code">[ApiVersion(&quot;1.0&quot;)]
[ApiVersion(&quot;1.1&quot;)]
[ApiController]
[Route(&quot;[controller]&quot;)]
public class JakeController : ControllerBase
{
    [HttpGet(&quot;{id}&quot;)]
    [MapToApiVersion(&quot;1.0&quot;)]
    public async Task&lt;IActionResult&gt; Get(int id)
    {
        var command = new GetJakeCommand {Id = id};
        var result = await mediator.Send(command);

        return Ok(result);
    }

    [HttpGet(&quot;{id}&quot;)]
    [MapToApiVersion(&quot;1.1&quot;)]
    public async Task&lt;IActionResult&gt; GetV1_1(int id)
    {
        var command = new GetJakeCommand {Id = id};
        var result = await mediator.Send(command);

        return Ok(result);
    }
}</code>
        </deckgo-highlight-code>
<p>만약, <code>MapToApiVersion</code> 어트리뷰트가 없다면 앞서 설정한 기본 버전을 사용하는 것으로 간주한다. 그래서 <code>Get</code> 메서드를 수식하는 <code>[MapToApiVersion("1.0")]</code>을 생략할 수도 있다.
실제 운영에는 문제가 없지만 Swagger UI를 사용할 때, 문제가 되므로 명시적으로 매핑 어트리뷰트를 유지하는 것이 좋다.</p>
<h2>버전관리 방법</h2>
<p>버전관리에는 네가지 방법이 있다. 또한, 그중 몇가지를 섞어서 사용하는 방법도 가능하다. 선택한 방식에 따라 클라이언트에서 요청을 만드는 방식이 달라지고 서버에서도 대응하는 설정을 해야한다.</p>
<h3>쿼리 스트링</h3>
<p>쿼리 파라미터를 사용하는 것이 기본 값이다. 파라미터 명은 <code>api-version</code>이고 다음과 같이 사용한다.</p>
<deckgo-highlight-code  terminal="carbon" theme="one-light" line-numbers="true"  >
          <code slot="code">https://{domain}/api/controller?api-version=1.1</code>
        </deckgo-highlight-code>
<p>기본 값이라 별도 설정이 필요 없지만 명시적인 방식을 선호한다면 다음과 같이 설정한다.</p>
<deckgo-highlight-code language="csharp" terminal="carbon" theme="one-light" line-numbers="true"  >
          <code slot="code">config.ApiVersionReader = new QueryStringApiVersionReader();</code>
        </deckgo-highlight-code>
<p>URL이 지저분해지는 단점이 있지만 가장 간단하고 직관적인 방법이다.</p>
<h3>요청 헤더</h3>
<p>클라이언트에서 요청을 만들때, 사용자 헤더를 사용하여 버전을 지정한다.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/146c95f012509e4a1d109c17d7da048d/1c1a4/x-version.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 27%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAsElEQVQY021PXQuDMBDr//9/gm9DGKMP2mprq/2wGTlQcLMQmiO53J1a1xXLsiClBO+9cGLfdxhjoLWG8bPU1lrEGMEe8nme5d+2TXoJFULANE3S4JyTkMV51C0gfgb49wtRDyjOYk8JJWfknCXkRClFFiIUC05kIEVyCrfXgNaagP7jOO5yaxdXtVZZlYG/phsA0DuO4+X987QG1fc9uq4DT+fJnE48mRnI7Z+0M/ALxyOGFjTFrtUAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="x-version"
        title="x-version"
        src="/static/146c95f012509e4a1d109c17d7da048d/5a190/x-version.png"
        srcset="/static/146c95f012509e4a1d109c17d7da048d/772e8/x-version.png 200w,
/static/146c95f012509e4a1d109c17d7da048d/e17e5/x-version.png 400w,
/static/146c95f012509e4a1d109c17d7da048d/5a190/x-version.png 800w,
/static/146c95f012509e4a1d109c17d7da048d/1c1a4/x-version.png 1046w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></p>
<p>사용자 헤더명을 서버 설정에서 정의한다.</p>
<deckgo-highlight-code language="csharp" terminal="carbon" theme="one-light" line-numbers="true"  >
          <code slot="code">config.ApiVersionReader = new HeaderApiVersionReader(&quot;X-Version&quot;);</code>
        </deckgo-highlight-code>
<p>버전이 숨어 있어 직관적이지 않지만 URL을 조작하지 않아도 되기 때문에 가장 선호되는 방식이다.</p>
<h3>Accept 헤더 재사용 (미디어 타입)</h3>
<p>Accept 헤더는 클라이언트가 서버에게 어떤 미디어를 (모든 미디어 <code>*.*</code> 또는 <code>application/json</code> 처럼 특정 미디어) 원하는지 알릴때 사용한다. 사용자 헤더를 따로 정의하지 않고 아래와 같이 Accept 헤더를 재사용한다.</p>
<deckgo-highlight-code  terminal="carbon" theme="one-light" line-numbers="true"  >
          <code slot="code">GET /resource/4
Accept: application/json;v=1.1</code>
        </deckgo-highlight-code>
<p>단점이라면 구현만 봤을때, 명확하지 않은 느낌이 있다. 클라이언트에서 구현하는게 용이하지 않을 수도 있다.</p>
<deckgo-highlight-code  terminal="carbon" theme="one-light" line-numbers="true"  >
          <code slot="code">config.ApiVersionReader = new MediaTypeApiVersionReader();</code>
        </deckgo-highlight-code>
<h3>URL 경로</h3>
<p>URL 경로에 명시적으로 버전을 사용하는 방식이다.</p>
<deckgo-highlight-code  terminal="carbon" theme="one-light" line-numbers="true"  >
          <code slot="code">https://{domain}/api/v1.1/resource</code>
        </deckgo-highlight-code>
<p>리소스(컨트롤러) 앞에 버전이 명시되므로 쿼리 스트링 방식보다도 눈에 더 잘 띈다. API의 버전 변경이 전방위적으로 일어날 때, 모든 리소스의 버전 업그레이드가 동시에 일어나 전체 URL의 버전을 업그레이드하는 상황이 이상적이다. 만약, 버전이 다른 URL을 섞어서 사용한다면 그것이 에러인지 의도적인 것인지 오히려 혼동을 줄 수도 있기 때문이다.</p>
<deckgo-highlight-code language="csharp" terminal="carbon" theme="one-light" line-numbers="true"  >
          <code slot="code">config.ApiVersionReader = new UrlSegmentApiVersionReader();

// 컨트롤러에서 라우팅을 변경해야 한다
[Route(&quot;api/v{version:apiVersion}/[controller]&quot;)]</code>
        </deckgo-highlight-code>
<h2>멀티 버전 관리</h2>
<p>위에서 살펴본 네가지 방식을 섞어서 사용하는 것이 가능하다. 기대 이상의 기능을 <code>Microsoft.AspNetCore.Mvc.Versioning</code> 패키지가 제공한다.</p>
<deckgo-highlight-code language="csharp" terminal="carbon" theme="one-light" line-numbers="true"  >
          <code slot="code">config.ApiVersionReader = ApiVersionReader.Combine(new HeaderApiVersionReader(&quot;X-Version&quot;), new QueryStringApiVersionReader(&quot;api-version&quot;));</code>
        </deckgo-highlight-code>
<h2>지원 종료된 버전 알리기</h2>
<p>서버에서 지원 가능한 API 버전을 응답헤더를 통해 내려 줬듯이 더 이상 지원하지 않는 버전도 설정할 수 있다. 클라이언트에서는 <code>api-deprecated-versions</code> 헤더에 명시된 버전을 사용하지 않도록 유의해야 한다.</p>
<deckgo-highlight-code language="csharp" terminal="carbon" theme="one-light" line-numbers="true"  >
          <code slot="code">[ApiVersion(&quot;1.0&quot;, Deprecated = true)]
[ApiVersion(&quot;1.1&quot;)]
[ApiController]
[Route(&quot;[controller]&quot;)]
public class JakeController : ControllerBase
{
   ...
}</code>
        </deckgo-highlight-code>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/c0450fef1b1f5d8f4b191779e40a3107/d7e70/api-deprecated-versions.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 38.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAwElEQVQoz41R7QqDMBDr+7/jYH/Gxhj9srVqPzLScUNFNoUQe97FXKqccxiGAWR9v+FxvcCbJ7z30FpjHEcsy4J5njdMcE4HCxsdYoh4DRqqlIIQAsglReTgO9dae428R2ut/zCl1N9bbZ96bVAsUHCaJvBpAjb+AJ1TlC5jjF2DrOQjVxan/8QIDltrIZFRnPNfh2zIOZ8SkxlCopF41Nr+uunsyvv6ZmVCwv4nyts+2qgLMgNjTM+E4PmM4FHPG93tc3ruLzvGAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="api-deprecated-versions"
        title="api-deprecated-versions"
        src="/static/c0450fef1b1f5d8f4b191779e40a3107/5a190/api-deprecated-versions.png"
        srcset="/static/c0450fef1b1f5d8f4b191779e40a3107/772e8/api-deprecated-versions.png 200w,
/static/c0450fef1b1f5d8f4b191779e40a3107/e17e5/api-deprecated-versions.png 400w,
/static/c0450fef1b1f5d8f4b191779e40a3107/5a190/api-deprecated-versions.png 800w,
/static/c0450fef1b1f5d8f4b191779e40a3107/c1b63/api-deprecated-versions.png 1200w,
/static/c0450fef1b1f5d8f4b191779e40a3107/d7e70/api-deprecated-versions.png 1286w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></p>
<h2>결론</h2>
<p>이상 네가지 방식을 통해 각기 사용하거나 섞어 쓰는 방식으로 대부분의 시나리오를 만족시킬 수 있을 것 같다. 개인적으로는 사용자 헤더를 사용하는 방식이 깔끔해 보인다. URL을 깨끗하게 유지할 수 있고, 전용 헤더를 사용하기 때문이다. 다만, URL이 서버단 캐싱에 사용된다면, API 버전 업그레이드시 고려해야 할 것이다.</p></div></div></div><footer class="footer-module--container--5GliC"><div class="footer-module--footer--Z1xkR">My new Gatsby Blog 2019</div></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/api-버전관리/";window.___webpackCompilationHash="a7e105900d1278046e0c";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-82df740e7cad994d0af0.js"],"app":["/app-0c385512a1f64cc6d7f4.js"],"component---src-pages-404-js":["/component---src-pages-404-js-0e83c4e916c6a584f6a1.js"],"component---src-pages-about-js":["/component---src-pages-about-js-236d410604323c4aaa79.js"],"component---src-pages-index-js":["/component---src-pages-index-js-740cf792298a614a522c.js"],"component---src-templates-post-js":["/component---src-templates-post-js-8b3119005e232a8c0f47.js"]};/*]]>*/</script><script src="/polyfill-82df740e7cad994d0af0.js" nomodule=""></script><script src="/app-0c385512a1f64cc6d7f4.js" async=""></script><script src="/framework-ece53a4dfa3f421a9587.js" async=""></script><script src="/webpack-runtime-ac1ba28d15bf0e2ece1e.js" async=""></script></body></html>